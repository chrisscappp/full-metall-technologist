import{r as e,j as s,H as h,B as E,L as g,T as u,c as j}from"./index-Dc0lYbGn.js";import{i as S}from"./PersonalComputingPage-0hF2OQSp.js";import{s as N}from"./index-C0KQb3kg.js";import"./Input-Cx1eHjTj.js";const T=m=>{const{className:f,data:r,generatedFunctionName:o,reportName:c="Отчет"}=m,[p,i]=e.useState(!1),[t,n]=e.useState(""),[l,x]=e.useState("");e.useEffect(()=>{t&&setTimeout(()=>{n("")},3e3)},[t]);const d=e.useCallback(async()=>{try{n(""),x("");const a=await N({filters:[{name:"Excel filters",extensions:["xls","xlsx"]}],defaultPath:c});if(i(!0),!a||!o||!r)return;await S(o,{outputPath:a,data:r}),n("Отчет успешно сгенерирован!")}catch(a){console.log(a),x(JSON.stringify("Произошла ошибка при попытке сгенерировать отчет. Попробуйте ещё раз"))}finally{i(!1)}},[r,o,c]);return s.jsxs(h,{className:j("",{},[f]),gap:"12",align:"center",max:!0,children:[s.jsx(E,{onClick:d,theme:"outline",children:"Сохранить в Excel"}),p&&s.jsx(g,{size:"loader_s"}),t&&s.jsx(u,{text:t,theme:"secondary",size:"size_s"}),l&&s.jsx(u,{text:l,theme:"error",size:"size_s"})]})};export{T as default};
